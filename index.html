<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Circl Chat - ÿØÿ±ÿØÿ¥ÿ© ŸÖÿ®ÿßÿ¥ÿ±ÿ© ŸÖÿ™ÿ∑Ÿàÿ±ÿ©</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-light: #818cf8;
            --primary-dark: #4f46e5;
            --secondary: #ec4899;
            --secondary-light: #f472b6;
            --secondary-dark: #db2777;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --dark: #1f2937;
            --light: #f9fafb;
            --bronze: #cd7f32;
            --silver: #c0c0c0;
            --gold: #fbbf24;
            --diamond: #60a5fa;
            --king: #a855f7;
            --queen: #ec4899;
            --owner: #dc2626;
            --admin: #059669;
            --moderator: #3b82f6;
            --vip: #f59e0b;
            --user: #6b7280;
            --gradient-primary: linear-gradient(135deg, #6366f1 0%, #ec4899 100%);
            --gradient-secondary: linear-gradient(135deg, #fbbf24 0%, #f97316 100%);
            --gradient-dark: linear-gradient(135deg, #1f2937 0%, #374151 100%);
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --radius-sm: 0.375rem;
            --radius: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #1f2937;
            line-height: 1.6;
        }

        /* ÿ™ÿµŸÖŸäŸÖ ÿ£ŸÜŸäŸÇ ŸÑŸÑŸÜÿµŸàÿµ */
        h1, h2, h3, h4 {
            font-weight: 700;
            line-height: 1.2;
        }

        .chat-container {
            width: 100%;
            max-width: 1600px;
            height: 95vh;
            background: white;
            border-radius: var(--radius-2xl);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            display: flex;
            transition: all 0.3s ease;
        }

        /* ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿä */
        .sidebar {
            width: 380px;
            background: #111827;
            color: white;
            display: flex;
            flex-direction: column;
            position: relative;
            transition: all 0.3s ease;
        }

        /* ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ */
        .user-profile {
            padding: 1.5rem;
            text-align: center;
            border-bottom: 1px solid #374151;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            position: relative;
        }

        .user-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            overflow: hidden;
            margin: 0 auto 1rem;
            border: 4px solid;
            position: relative;
            transition: transform 0.3s ease;
        }

        .user-avatar:hover {
            transform: scale(1.05);
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .online-status {
            position: absolute;
            bottom: 8px;
            right: 8px;
            width: 20px;
            height: 20px;
            background: var(--success);
            border-radius: 50%;
            border: 3px solid #111827;
        }

        .username {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .user-role {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .role-owner { background: var(--owner); color: white; }
        .role-admin { background: var(--admin); color: white; }
        .role-moderator { background: var(--moderator); color: white; }
        .role-vip { background: var(--vip); color: white; }
        .role-user { background: var(--user); color: white; }

        .user-status {
            color: #9ca3af;
            font-size: 0.875rem;
        }

        /* ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ŸÇÿØŸÖ */
        .level-container {
            padding: 1rem 1.5rem;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid #374151;
        }

        .level-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .level-text {
            font-size: 0.875rem;
            color: #9ca3af;
        }

        .level-rank {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 700;
            font-size: 0.875rem;
        }

        .rank-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .beginner { background: #4b5563; color: white; }
        .bronze { background: var(--bronze); color: white; }
        .silver { background: var(--silver); color: #1f2937; }
        .gold { background: var(--gold); color: #1f2937; }
        .diamond { background: var(--diamond); color: white; }
        .king { background: var(--king); color: white; }
        .queen { background: var(--queen); color: white; }

        .progress-bar {
            height: 8px;
            background: #374151;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .xp-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: #9ca3af;
        }

        /* ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ∫ÿ±ŸÅ */
        .rooms-section {
            padding: 1.5rem;
            flex: 1;
            overflow-y: auto;
        }

        .rooms-section::-webkit-scrollbar {
            width: 6px;
        }

        .rooms-section::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .rooms-section::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        .section-title {
            font-size: 0.875rem;
            color: #9ca3af;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .room-count-badge {
            background: var(--primary);
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
        }

        .room-list {
            list-style: none;
        }

        .room-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            border-radius: var(--radius-lg);
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            border: 1px solid transparent;
        }

        .room-item:hover {
            background: rgba(99, 102, 241, 0.1);
            border-color: rgba(99, 102, 241, 0.2);
            transform: translateX(-5px);
        }

        .room-item.active {
            background: rgba(99, 102, 241, 0.15);
            border-right: 4px solid var(--primary);
        }

        .room-icon {
            margin-left: 1rem;
            font-size: 1.25rem;
            color: #9ca3af;
        }

        .room-item.active .room-icon {
            color: var(--primary);
        }

        .room-info {
            flex: 1;
        }

        .room-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .room-stats {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.75rem;
            color: #9ca3af;
        }

        .room-user-count {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .room-limit {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
        }

        .room-full .room-limit {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .featured-room {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(236, 72, 153, 0.1));
            border-color: rgba(251, 191, 36, 0.2);
        }

        .room-vip {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(99, 102, 241, 0.1));
            border-color: rgba(168, 85, 247, 0.2);
        }

        /* ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ */
        .users-section {
            padding: 1.5rem;
            border-top: 1px solid #374151;
        }

        .user-list {
            list-style: none;
        }

        .user-list-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            border-radius: var(--radius);
            margin-bottom: 0.5rem;
            position: relative;
            transition: all 0.3s ease;
        }

        .user-list-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .user-list-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            overflow: hidden;
            margin-left: 0.75rem;
            border: 2px solid;
            position: relative;
        }

        .user-list-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-rank-indicator {
            position: absolute;
            bottom: -4px;
            right: -4px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #111827;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
            border: 2px solid white;
        }

        .user-rank-indicator.king { color: var(--king); }
        .user-rank-indicator.queen { color: var(--queen); }
        .user-rank-indicator.diamond { color: var(--diamond); }
        .user-rank-indicator.gold { color: var(--gold); }
        .user-rank-indicator.silver { color: var(--silver); }
        .user-rank-indicator.bronze { color: var(--bronze); }

        .user-list-info {
            flex: 1;
            min-width: 0;
        }

        .user-list-name {
            font-weight: 500;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .user-list-status {
            font-size: 0.75rem;
            color: #9ca3af;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .user-list-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
        }

        .owner-badge {
            background: var(--owner);
            color: white;
            padding: 0.125rem 0.5rem;
            border-radius: 50px;
            font-size: 0.625rem;
            font-weight: 600;
            margin-right: 0.25rem;
        }

        .admin-badge {
            background: var(--admin);
            color: white;
            padding: 0.125rem 0.5rem;
            border-radius: 50px;
            font-size: 0.625rem;
            font-weight: 600;
            margin-right: 0.25rem;
        }

        .moderator-badge {
            background: var(--moderator);
            color: white;
            padding: 0.125rem 0.5rem;
            border-radius: 50px;
            font-size: 0.625rem;
            font-weight: 600;
            margin-right: 0.25rem;
        }

        .vip-badge {
            background: var(--vip);
            color: white;
            padding: 0.125rem 0.5rem;
            border-radius: 50px;
            font-size: 0.625rem;
            font-weight: 600;
            margin-right: 0.25rem;
        }

        .verified-badge {
            color: #3b82f6;
            font-size: 0.875rem;
        }

        /* ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿØÿ±ÿØÿ¥ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© */
        .chat-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: linear-gradient(180deg, #f9fafb 0%, #f3f4f6 100%);
        }

        /* ÿ¥ÿ±Ÿäÿ∑ ÿ£ÿπŸÑŸâ ÿßŸÑÿØÿ±ÿØÿ¥ÿ© */
        .chat-header {
            padding: 1.25rem 2rem;
            background: white;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow-sm);
        }

        .current-room-info {
            display: flex;
            align-items: center;
        }

        .room-avatar {
            width: 56px;
            height: 56px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 1rem;
            color: white;
            font-size: 1.5rem;
            box-shadow: var(--shadow);
        }

        .room-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 0.25rem;
        }

        .room-desc {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .chat-actions {
            display: flex;
            gap: 0.75rem;
        }

        .chat-action-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            background: #f3f4f6;
            color: #4b5563;
            font-size: 1.125rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-action-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ */
        .messages-container {
            flex: 1;
            padding: 1.5rem 2rem;
            overflow-y: auto;
            background: linear-gradient(180deg, #f9fafb 0%, #f3f4f6 100%);
        }

        .messages-container::-webkit-scrollbar {
            width: 8px;
        }

        .messages-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 4px;
        }

        .messages-container::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 4px;
        }

        .messages-container::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        .message-date {
            text-align: center;
            margin: 1.5rem 0;
            position: relative;
        }

        .date-line {
            display: inline-block;
            background: white;
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            font-size: 0.875rem;
            color: #6b7280;
            box-shadow: var(--shadow-sm);
            border: 1px solid #e5e7eb;
        }

        /* ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ */
        .message {
            display: flex;
            margin-bottom: 1.5rem;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            overflow: hidden;
            margin-left: 1rem;
            flex-shrink: 0;
            border: 3px solid;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .message-avatar:hover {
            transform: scale(1.05);
        }

        .message-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .message-rank {
            position: absolute;
            bottom: -6px;
            right: -6px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            border: 2px solid #111827;
            box-shadow: var(--shadow-sm);
        }

        .message-content {
            flex: 1;
            background: white;
            padding: 1.25rem;
            border-radius: var(--radius-xl);
            border-top-right-radius: var(--radius-sm);
            box-shadow: var(--shadow);
            max-width: 75%;
            transition: all 0.3s ease;
            border: 1px solid #e5e7eb;
        }

        .message-content:hover {
            box-shadow: var(--shadow-lg);
        }

        .message.my-message {
            flex-direction: row-reverse;
        }

        .message.my-message .message-avatar {
            margin-left: 0;
            margin-right: 1rem;
        }

        .message.my-message .message-content {
            background: var(--gradient-primary);
            color: white;
            border-top-right-radius: var(--radius-xl);
            border-top-left-radius: var(--radius-sm);
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .message-sender {
            font-weight: 700;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .message-time {
            font-size: 0.75rem;
            color: #9ca3af;
        }

        .message.my-message .message-time {
            color: rgba(255, 255, 255, 0.8);
        }

        .message-text {
            line-height: 1.6;
            font-size: 1rem;
            margin-bottom: 0.5rem;
            word-break: break-word;
        }

        .message-actions {
            display: flex;
            gap: 1rem;
            margin-top: 0.75rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .message:hover .message-actions {
            opacity: 1;
        }

        .message-action-btn {
            background: none;
            border: none;
            color: #9ca3af;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-sm);
        }

        .message-action-btn:hover {
            color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 0.75rem 1.5rem;
            color: #6b7280;
            font-size: 0.875rem;
            background: white;
            border-radius: var(--radius-lg);
            margin: 0 2rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid #e5e7eb;
        }

        .typing-dots {
            display: flex;
            margin-right: 0.75rem;
        }

        .typing-dots span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #9ca3af;
            margin: 0 2px;
            animation: typing 1.4s infinite;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }

        /* ŸÖŸÜÿ∑ŸÇÿ© ÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© */
        .message-input-container {
            padding: 1.5rem 2rem;
            background: white;
            border-top: 1px solid #e5e7eb;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
        }

        .input-wrapper {
            display: flex;
            align-items: center;
            background: #f9fafb;
            border-radius: var(--radius-xl);
            padding: 0.5rem 0.5rem 0.5rem 1.5rem;
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }

        .input-wrapper:focus-within {
            background: white;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .message-input {
            flex: 1;
            border: none;
            background: transparent;
            padding: 1rem 0;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            color: #111827;
            outline: none;
            resize: none;
            min-height: 24px;
            max-height: 120px;
            line-height: 1.5;
        }

        .input-actions {
            display: flex;
            gap: 0.5rem;
        }

        .input-action-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: none;
            background: transparent;
            color: #6b7280;
            font-size: 1.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .input-action-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .send-btn {
            background: var(--gradient-primary);
            color: white;
            width: 52px;
            height: 52px;
            box-shadow: var(--shadow);
        }

        .send-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
            box-shadow: var(--shadow-lg);
        }

        /* ŸÜÿßŸÅÿ∞ÿ© ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .login-box {
            background: white;
            padding: 3rem;
            border-radius: var(--radius-2xl);
            width: 90%;
            max-width: 500px;
            text-align: center;
            animation: popIn 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            box-shadow: var(--shadow-xl);
            border: 1px solid #e5e7eb;
        }

        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .login-title {
            font-size: 2rem;
            color: #111827;
            margin-bottom: 2rem;
            font-weight: 800;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .avatar-selection {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .avatar-option {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            overflow: hidden;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            position: relative;
        }

        .avatar-option.selected {
            border-color: var(--primary);
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
        }

        .avatar-option img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .username-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: var(--radius-lg);
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            text-align: center;
        }

        .username-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .social-login {
            margin: 1.5rem 0;
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .social-btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: var(--radius-lg);
            font-family: 'Tajawal', sans-serif;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: all 0.3s ease;
            flex: 1;
            justify-content: center;
        }

        .social-btn.google {
            background: white;
            color: #111827;
            border: 1px solid #e5e7eb;
        }

        .social-btn.facebook {
            background: #1877F2;
            color: white;
        }

        .social-btn.instagram {
            background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D);
            color: white;
        }

        .social-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .join-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 1.25rem 3rem;
            border-radius: var(--radius-xl);
            font-family: 'Tajawal', sans-serif;
            font-size: 1.125rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 1rem;
            letter-spacing: 0.5px;
        }

        .join-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .verified-note {
            color: #3b82f6;
            font-size: 0.875rem;
            margin-top: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        /* ŸÜÿßŸÅÿ∞ÿ© VIP */
        .vip-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1002;
            backdrop-filter: blur(5px);
        }

        .vip-box {
            background: white;
            padding: 3rem;
            border-radius: var(--radius-2xl);
            width: 90%;
            max-width: 400px;
            text-align: center;
            animation: popIn 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            box-shadow: var(--shadow-xl);
            border: 1px solid #e5e7eb;
        }

        .vip-title {
            font-size: 1.5rem;
            color: #111827;
            margin-bottom: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        .vip-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: var(--radius-lg);
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            margin-bottom: 1.5rem;
            text-align: center;
            letter-spacing: 2px;
            font-weight: 600;
        }

        .vip-input:focus {
            outline: none;
            border-color: var(--vip);
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
        }

        .vip-buttons {
            display: flex;
            gap: 1rem;
        }

        .vip-btn {
            flex: 1;
            padding: 1rem;
            border: none;
            border-radius: var(--radius-lg);
            font-family: 'Tajawal', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .vip-btn.enter {
            background: var(--vip);
            color: white;
        }

        .vip-btn.cancel {
            background: #f3f4f6;
            color: #4b5563;
        }

        .vip-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* ÿ™Ÿäÿ¨ÿßŸÜ ŸàÿØÿ±Ÿàÿπ */
        .crown-badge {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.5rem;
            color: var(--gold);
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
            animation: glow 2s infinite alternate;
        }

        .shield-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            font-size: 1.25rem;
            color: var(--silver);
        }

        .star-badge {
            position: absolute;
            bottom: -6px;
            left: -6px;
            font-size: 1rem;
            color: var(--bronze);
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px rgba(251, 191, 36, 0.5); }
            to { text-shadow: 0 0 20px rgba(251, 191, 36, 0.8); }
        }

        /* ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑŸÖÿ™ÿ¨ÿ± */
        .store-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            backdrop-filter: blur(5px);
        }

        .store-box {
            background: white;
            padding: 2.5rem;
            border-radius: var(--radius-2xl);
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            border: 1px solid #e5e7eb;
        }

        .store-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .store-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #111827;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .donate-balance {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: var(--gradient-primary);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
        }

        .donate-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem;
            border: 1px solid #e5e7eb;
            border-radius: var(--radius-lg);
            margin-bottom: 1rem;
            transition: all 0.3s;
            background: #f9fafb;
        }

        .donate-item:hover {
            border-color: var(--primary);
            background: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .donate-price {
            background: var(--primary);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .donate-price:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        /* ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ•ÿπŸÑÿßŸÜ */
        .ad-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1003;
            backdrop-filter: blur(10px);
        }

        .ad-box {
            background: white;
            padding: 3rem;
            border-radius: var(--radius-2xl);
            width: 90%;
            max-width: 600px;
            text-align: center;
            animation: popIn 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            box-shadow: var(--shadow-xl);
            border: 1px solid #e5e7eb;
        }

        .ad-icon {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .ad-title {
            font-size: 1.75rem;
            color: #111827;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .ad-text {
            font-size: 1.125rem;
            color: #6b7280;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .ad-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 1rem 3rem;
            border-radius: var(--radius-xl);
            font-family: 'Tajawal', sans-serif;
            font-size: 1.125rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ad-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿÆÿßÿµÿ© */
        .pm-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1004;
            backdrop-filter: blur(10px);
        }

        .pm-box {
            background: white;
            width: 90%;
            max-width: 800px;
            height: 80vh;
            border-radius: var(--radius-2xl);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-xl);
            border: 1px solid #e5e7eb;
        }

        .pm-header {
            padding: 1.5rem 2rem;
            background: white;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .pm-recipient {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .pm-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #6b7280;
            cursor: pointer;
            transition: color 0.3s;
        }

        .pm-close:hover {
            color: var(--danger);
        }

        .pm-messages {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            background: #f9fafb;
        }

        .pm-input-container {
            padding: 1.5rem;
            background: white;
            border-top: 1px solid #e5e7eb;
        }

        /* ÿ™ÿ¨ÿßŸàÿ® ŸÖÿπ ÿßŸÑÿ¥ÿßÿ¥ÿßÿ™ */
        @media (max-width: 1200px) {
            .chat-container {
                height: 100vh;
                border-radius: 0;
                max-width: 100%;
            }
            
            .sidebar {
                width: 350px;
            }
        }

        @media (max-width: 768px) {
            .chat-container {
                flex-direction: column;
                height: 100vh;
            }
            
            .sidebar {
                position: fixed;
                left: -100%;
                top: 0;
                bottom: 0;
                z-index: 100;
                transition: left 0.3s ease;
                width: 85%;
                height: 100%;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .chat-main {
                width: 100%;
            }
            
            .room-stats {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }
            
            .message-content {
                max-width: 85%;
            }
            
            .login-box, .vip-box, .ad-box {
                padding: 2rem;
                margin: 1rem;
            }
            
            .social-login {
                flex-direction: column;
            }
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .floating {
            animation: floating 3s infinite ease-in-out;
        }

        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        /* ÿ£ÿ≤ÿ±ÿßÿ± ÿ•ÿ∂ÿßŸÅŸäÿ© */
        .voice-call-btn, .video-call-btn {
            position: relative;
        }

        .voice-call-btn.active {
            background: var(--success);
            color: white;
        }

        .video-call-btn.active {
            background: var(--danger);
            color: white;
        }

        /* ŸÖÿ§ÿ¥ÿ± ÿßŸÑŸÖŸÉÿßŸÑŸÖÿ© */
        .call-indicator {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: var(--gradient-primary);
            color: white;
            padding: 1rem 2rem;
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            gap: 1rem;
            z-index: 999;
            box-shadow: var(--shadow-xl);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .call-actions {
            display: flex;
            gap: 0.5rem;
        }

        .call-action-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .call-action-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .call-action-btn.end-call {
            background: var(--danger);
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑŸÜÿµ */
        .text-gradient {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body>
    <!-- ŸÜÿßŸÅÿ∞ÿ© ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-box">
            <div class="login-title">üöÄ ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ŸÉ ŸÅŸä Circl Chat</div>
            
            <div class="avatar-selection">
                <div class="avatar-option selected" data-avatar="1">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Ahmed&backgroundColor=6366f1" alt="ÿµŸàÿ±ÿ© ÿ¥ÿÆÿµŸäÿ©">
                </div>
                <div class="avatar-option" data-avatar="2">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Sara&backgroundColor=ec4899" alt="ÿµŸàÿ±ÿ© ÿ¥ÿÆÿµŸäÿ©">
                </div>
                <div class="avatar-option" data-avatar="3">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Mohamed&backgroundColor=10b981" alt="ÿµŸàÿ±ÿ© ÿ¥ÿÆÿµŸäÿ©">
                </div>
                <div class="avatar-option" data-avatar="4">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Noah&backgroundColor=f59e0b" alt="ÿµŸàÿ±ÿ© ÿ¥ÿÆÿµŸäÿ©">
                </div>
            </div>
            
            <input type="text" class="username-input" id="usernameInput" placeholder="ÿßÿÆÿ™ÿ± ÿßÿ≥ŸÖ ŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÅÿ±ŸäÿØ (ŸÑŸÜ ÿ™ÿ≥ÿ™ÿ∑Ÿäÿπ ÿ™ÿ∫ŸäŸäÿ±Ÿá)" maxlength="20" autocomplete="off">
            
            <div class="social-login">
                <button class="social-btn google" id="googleBtn">
                    <i class="fab fa-google"></i> ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ÿ≠ÿ≥ÿßÿ® Google
                </button>
                <button class="social-btn facebook" id="facebookBtn">
                    <i class="fab fa-facebook-f"></i> ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ŸÄ Facebook
                </button>
            </div>
            
            <div class="verified-note">
                <i class="fas fa-check-circle"></i>
                ÿßŸÑÿ±ÿ®ÿ∑ Ÿäÿ≠ŸÇŸÇ ÿ≠ÿ≥ÿßÿ®ŸÉ ŸàŸäÿ∂ŸäŸÅ ÿπŸÑÿßŸÖÿ© ÿßŸÑÿ™ÿ≠ŸÇŸÇ ÿßŸÑÿ≤ÿ±ŸÇÿßÿ°
            </div>
            
            <button class="join-btn" id="joinBtn">
                <i class="fas fa-sign-in-alt"></i> ÿØÿÆŸàŸÑ ÿ•ŸÑŸâ ÿßŸÑÿØÿ±ÿØÿ¥ÿ©
            </button>
            
            <div style="margin-top: 1.5rem; font-size: 0.875rem; color: #6b7280;">
                <p>ÿ®ÿßŸÑÿØÿÆŸàŸÑÿå ŸÅÿ•ŸÜŸÉ ÿ™ŸàÿßŸÅŸÇ ÿπŸÑŸâ <a href="#" style="color: var(--primary); text-decoration: none;">ÿ¥ÿ±Ÿàÿ∑ ÿßŸÑÿÆÿØŸÖÿ©</a> Ÿà <a href="#" style="color: var(--primary); text-decoration: none;">ÿ≥Ÿäÿßÿ≥ÿ© ÿßŸÑÿÆÿµŸàÿµŸäÿ©</a></p>
            </div>
        </div>
    </div>

    <!-- ŸÜÿßŸÅÿ∞ÿ© VIP -->
    <div class="vip-overlay" id="vipOverlay">
        <div class="vip-box">
            <div class="vip-title">
                <i class="fas fa-crown"></i>
                ÿ∫ÿ±ŸÅÿ© VIP ÿßŸÑÿÆÿßÿµÿ©
            </div>
            <p style="color: #6b7280; margin-bottom: 1.5rem; line-height: 1.6;">Ÿáÿ∞Ÿá ÿßŸÑÿ∫ÿ±ŸÅÿ© ÿÆÿßÿµÿ© ÿ®ÿßŸÑÿ£ÿπÿ∂ÿßÿ° ÿßŸÑŸÖŸÖŸäÿ≤ŸäŸÜ. Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ÿ±ŸÖÿ≤ ÿßŸÑÿØÿÆŸàŸÑ:</p>
            <input type="password" class="vip-input" id="vipCode" placeholder="ÿ£ÿØÿÆŸÑ ÿ±ŸÖÿ≤ VIP" maxlength="10">
            <div class="vip-buttons">
                <button class="vip-btn cancel" id="vipCancelBtn">ÿ•ŸÑÿ∫ÿßÿ°</button>
                <button class="vip-btn enter" id="vipEnterBtn">ÿØÿÆŸàŸÑ</button>
            </div>
        </div>
    </div>

    <!-- ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ•ÿπŸÑÿßŸÜ -->
    <div class="ad-overlay" id="adOverlay">
        <div class="ad-box">
            <div class="ad-icon">
                <i class="fas fa-bell"></i>
            </div>
            <div class="ad-title" id="adTitle">ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿ∫ÿ±ŸÅÿ©</div>
            <div class="ad-text" id="adText"></div>
            <button class="ad-btn" id="adBtn">ŸÖÿ™ÿßÿ®ÿπÿ©</button>
        </div>
    </div>

    <!-- ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿÆÿßÿµÿ© -->
    <div class="pm-overlay" id="pmOverlay">
        <div class="pm-box">
            <div class="pm-header">
                <div class="pm-recipient">
                    <div class="user-list-avatar">
                        <img id="pmAvatar" src="" alt="ÿµŸàÿ±ÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ">
                    </div>
                    <div>
                        <div class="room-title" id="pmUsername"></div>
                        <div class="room-desc" id="pmStatus">ŸÖÿ™ÿµŸÑ ÿßŸÑÿ¢ŸÜ</div>
                    </div>
                </div>
                <button class="pm-close" id="pmCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="pm-messages" id="pmMessages">
                <!-- ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿÆÿßÿµÿ© ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
            </div>
            <div class="pm-input-container">
                <div class="input-wrapper">
                    <input type="text" class="message-input" id="pmInput" placeholder="ÿßŸÉÿ™ÿ® ÿ±ÿ≥ÿßŸÑÿ™ŸÉ ÿßŸÑÿÆÿßÿµÿ©..." autocomplete="off">
                    <div class="input-actions">
                        <button class="input-action-btn" title="ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿπÿ®Ÿäÿ±">
                            <i class="fas fa-smile"></i>
                        </button>
                        <button class="send-btn" id="pmSendBtn" title="ÿ•ÿ±ÿ≥ÿßŸÑ">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑŸÖÿ™ÿ¨ÿ± -->
    <div class="store-overlay" id="storeOverlay">
        <div class="store-box">
            <div class="store-header">
                <div class="store-title">
                    <i class="fas fa-shopping-cart"></i>
                    ŸÖÿ™ÿ¨ÿ± ÿßŸÑÿØŸàŸÜÿßÿ™
                </div>
                <div class="donate-balance">
                    <i class="fas fa-coins"></i>
                    <span>ÿ±ÿµŸäÿØŸÉ: <span id="donateBalance">0</span> ÿØŸàŸÜÿßÿ™</span>
                </div>
            </div>
            
            <div id="donateItems">
                <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ÿßŸÑÿ¨ÿßŸÅÿßÿ≥ŸÉÿ±Ÿäÿ®ÿ™ -->
            </div>
        </div>
    </div>

    <!-- ŸÖÿ§ÿ¥ÿ± ÿßŸÑŸÖŸÉÿßŸÑŸÖÿ© -->
    <div class="call-indicator" id="callIndicator" style="display: none;">
        <div>
            <div style="font-weight: 600;">ŸÖŸÉÿßŸÑŸÖÿ© ÿµŸàÿ™Ÿäÿ© ÿ¨ÿßÿ±Ÿäÿ©</div>
            <div style="font-size: 0.875rem; opacity: 0.9;" id="callTimer">00:00</div>
        </div>
        <div class="call-actions">
            <button class="call-action-btn" id="muteBtn" title="ŸÉÿ™ŸÖ ÿßŸÑÿµŸàÿ™">
                <i class="fas fa-microphone"></i>
            </button>
            <button class="call-action-btn end-call" id="endCallBtn" title="ÿ•ŸÜŸáÿßÿ° ÿßŸÑŸÖŸÉÿßŸÑŸÖÿ©">
                <i class="fas fa-phone-slash"></i>
            </button>
        </div>
    </div>

    <!-- ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿØÿ±ÿØÿ¥ÿ© -->
    <div class="chat-container" id="chatContainer" style="display: none;">
        <!-- ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿä -->
        <div class="sidebar">
            <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖÿπ ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ -->
            <div class="user-profile">
                <div class="user-avatar" id="userAvatar">
                    <img id="userAvatarImg" src="" alt="ÿµŸàÿ±ÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ">
                    <div class="online-status"></div>
                </div>
                <div class="username">
                    <span id="userDisplayName"></span>
                    <i class="fas fa-check-circle verified-badge" id="verifiedBadge" style="display: none;"></i>
                </div>
                <div class="user-role" id="userRole">ÿ≤ÿßÿ¶ÿ±</div>
                <div class="user-status" id="userStatus">ŸÖÿ™ÿµŸÑ ÿßŸÑÿ¢ŸÜ</div>
            </div>
            
            <!-- ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ŸÇÿØŸÖ -->
            <div class="level-container">
                <div class="level-info">
                    <div class="level-text">ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ <span id="userLevel">1</span></div>
                    <div class="level-rank">
                        <span class="rank-badge" id="rankBadge">ŸÖÿ®ÿ™ÿØÿ¶</span>
                        <i class="fas fa-crown" id="rankIcon" style="display: none;"></i>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="levelProgress" style="width: 10%;"></div>
                </div>
                <div class="xp-info">
                    <span id="currentXP">0 XP</span>
                    <span id="nextLevelXP">100 XP ŸÑŸÑŸàÿµŸàŸÑ ŸÑŸÑŸÖÿ≥ÿ™ŸàŸâ 2</span>
                </div>
            </div>
            
            <!-- ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ∫ÿ±ŸÅ -->
            <div class="rooms-section">
                <div class="section-title">
                    <span>ÿ∫ÿ±ŸÅ ÿßŸÑÿØÿ±ÿØÿ¥ÿ©</span>
                    <span class="room-count-badge" id="totalRoomsCount">5</span>
                </div>
                <ul class="room-list" id="roomList">
                    <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ÿßŸÑÿ¨ÿßŸÅÿßÿ≥ŸÉÿ±Ÿäÿ®ÿ™ -->
                </ul>
            </div>
            
            <!-- ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ -->
            <div class="users-section">
                <div class="section-title">
                    <span>ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸàŸÜ ÿßŸÑŸÖÿ™ÿµŸÑŸàŸÜ (<span id="onlineCount">0</span>)</span>
                    <span class="room-count-badge" id="totalUsersCount">0</span>
                </div>
                <ul class="user-list" id="userList">
                    <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ÿßŸÑÿ¨ÿßŸÅÿßÿ≥ŸÉÿ±Ÿäÿ®ÿ™ -->
                </ul>
            </div>
        </div>
        
        <!-- ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿØÿ±ÿØÿ¥ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© -->
        <div class="chat-main">
            <!-- ÿ¥ÿ±Ÿäÿ∑ ÿ£ÿπŸÑŸâ ÿßŸÑÿØÿ±ÿØÿ¥ÿ© -->
            <div class="chat-header">
                <div class="current-room-info">
                    <div class="room-avatar">
                        <i class="fas fa-users"></i>
                    </div>
                    <div>
                        <div class="room-title" id="currentRoomTitle">ÿπÿßŸÖ</div>
                        <div class="room-desc" id="currentRoomDesc">ÿßŸÑÿ∫ÿ±ŸÅÿ© ÿßŸÑÿπÿßŸÖÿ© ŸÑŸÑÿ¨ŸÖŸäÿπ | <span id="roomUsersCount">0</span> ŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖÿ™ÿµŸÑ</div>
                    </div>
                </div>
                
                <div class="chat-actions">
                    <button class="chat-action-btn" id="mobileMenuBtn" title="ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ©">
                        <i class="fas fa-bars"></i>
                    </button>
                    <button class="chat-action-btn" id="voiceCallBtn" title="ŸÖŸÉÿßŸÑŸÖÿ© ÿµŸàÿ™Ÿäÿ©">
                        <i class="fas fa-phone-alt"></i>
                    </button>
                    <button class="chat-action-btn" id="videoCallBtn" title="ŸÖŸÉÿßŸÑŸÖÿ© ŸÅŸäÿØŸäŸà">
                        <i class="fas fa-video"></i>
                    </button>
                    <button class="chat-action-btn" id="storeBtn" title="ŸÖÿ™ÿ¨ÿ± ÿßŸÑÿØŸàŸÜÿßÿ™">
                        <i class="fas fa-shopping-cart"></i>
                    </button>
                    <button class="chat-action-btn" id="rankingBtn" title="ÿ™ÿ±ÿ™Ÿäÿ® ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ">
                        <i class="fas fa-trophy"></i>
                    </button>
                    <button class="chat-action-btn" id="settingsBtn" title="ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
            
            <!-- ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ -->
            <div class="messages-container" id="messagesContainer">
                <!-- ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
                <div class="welcome-message" style="text-align: center; padding: 3rem 1.5rem; color: #6b7280;">
                    <i class="fas fa-comments" style="font-size: 4rem; margin-bottom: 1.5rem; opacity: 0.5;"></i>
                    <h3 style="margin-bottom: 0.75rem; color: #111827;">ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ŸÉ ŸÅŸä Circl Chat!</h3>
                    <p style="font-size: 1.125rem;">ÿßÿ®ÿØÿ£ ÿßŸÑŸÖÿ≠ÿßÿØÿ´ÿ© ŸÖÿπ ÿßŸÑÿ£ÿµÿØŸÇÿßÿ° ŸÅŸä ÿßŸÑÿ∫ÿ±ŸÅÿ©. ŸÉŸÑ ÿ±ÿ≥ÿßŸÑÿ© ÿ™ÿ≤ŸäÿØ ŸÖŸÜ ŸÖÿ≥ÿ™ŸàÿßŸÉ!</p>
                </div>
            </div>
            
            <!-- ŸÖÿ§ÿ¥ÿ± ÿßŸÑŸÉÿ™ÿßÿ®ÿ© -->
            <div class="typing-indicator" id="typingIndicator" style="display: none;">
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <span id="typingText">ŸäŸÉÿ™ÿ® ÿßŸÑÿ¢ŸÜ...</span>
            </div>
            
            <!-- ŸÖŸÜÿ∑ŸÇÿ© ÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© -->
            <div class="message-input-container">
                <div class="input-wrapper">
                    <input type="text" class="message-input" id="messageInput" placeholder="ÿßŸÉÿ™ÿ® ÿ±ÿ≥ÿßŸÑÿ™ŸÉ ŸáŸÜÿß... (ÿßÿ∂ÿ∫ÿ∑ Enter ŸÑŸÑÿ•ÿ±ÿ≥ÿßŸÑ)" autocomplete="off">
                    
                    <div class="input-actions">
                        <button class="input-action-btn" id="emojiBtn" title="ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿπÿ®Ÿäÿ±">
                            <i class="fas fa-smile"></i>
                        </button>
                        <button class="input-action-btn" id="imageBtn" title="ÿ•ÿ∂ÿßŸÅÿ© ÿµŸàÿ±ÿ©">
                            <i class="fas fa-image"></i>
                        </button>
                        <button class="input-action-btn" id="fileBtn" title="ÿ•ÿ±ÿ≥ÿßŸÑ ŸÖŸÑŸÅ">
                            <i class="fas fa-paperclip"></i>
                        </button>
                        <button class="input-action-btn" id="voiceBtn" title="ÿ±ÿ≥ÿßŸÑÿ© ÿµŸàÿ™Ÿäÿ©">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <button class="send-btn" id="sendBtn" title="ÿ•ÿ±ÿ≥ÿßŸÑ">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ŸÜÿ∏ÿßŸÖ ÿßŸÑŸÖÿ≥ÿ™ŸàŸäÿßÿ™ ŸàÿßŸÑÿ±ÿ™ÿ®
        const LEVEL_SYSTEM = {
            ranks: [
                { name: 'ŸÖÿ®ÿ™ÿØÿ¶', minLevel: 1, color: 'beginner', xpRequired: 0, icon: 'fa-seedling' },
                { name: 'ÿ®ÿ±ŸàŸÜÿ≤Ÿä', minLevel: 5, color: 'bronze', xpRequired: 500, icon: 'fa-award' },
                { name: 'ŸÅÿ∂Ÿä', minLevel: 10, color: 'silver', xpRequired: 2000, icon: 'fa-shield-alt' },
                { name: 'ÿ∞Ÿáÿ®Ÿä', minLevel: 20, color: 'gold', xpRequired: 5000, icon: 'fa-crown' },
                { name: 'ŸÖÿßÿ≥Ÿä', minLevel: 30, color: 'diamond', xpRequired: 10000, icon: 'fa-gem' },
                { name: 'ŸÉŸäŸÜÿ¨', minLevel: 40, color: 'king', xpRequired: 20000, forGender: 'male', icon: 'fa-crown' },
                { name: 'ŸÉŸàŸäŸÜ', minLevel: 40, color: 'queen', xpRequired: 20000, forGender: 'female', icon: 'fa-crown' }
            ],
            
            getRankInfo(xp, gender = 'male') {
                const level = Math.floor(xp / 100) + 1;
                let rank = this.ranks[0];
                
                for (let i = this.ranks.length - 1; i >= 0; i--) {
                    if (level >= this.ranks[i].minLevel && xp >= this.ranks[i].xpRequired) {
                        if (this.ranks[i].forGender && this.ranks[i].forGender !== gender) {
                            continue;
                        }
                        rank = this.ranks[i];
                        break;
                    }
                }
                
                return {
                    level,
                    rank: rank.name,
                    rankColor: rank.color,
                    rankIcon: rank.icon,
                    nextLevelXP: (level * 100),
                    currentLevelXP: xp % 100,
                    progress: ((xp % 100) / 100) * 100
                };
            }
        };

        // ŸÇÿßÿπÿØÿ© ÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿ≠ÿßŸÉÿßÿ©
        const DATABASE = {
            users: [],
            rooms: [
                { id: 1, name: 'ÿπÿßŸÖ', desc: 'ÿßŸÑÿ∫ÿ±ŸÅÿ© ÿßŸÑÿπÿßŸÖÿ© ŸÑŸÑÿ¨ŸÖŸäÿπ', limit: 500, users: [], featured: true, isPublic: true },
                { id: 2, name: 'ŸÖÿµÿ± üá™üá¨', desc: 'ÿ∫ÿ±ŸÅÿ© ŸÖÿµÿ± ÿßŸÑŸÖŸÖŸäÿ≤ÿ©', limit: 500, users: [], featured: true, isPublic: true },
                { id: 3, name: 'ÿßŸÑÿ£ŸÑÿπÿßÿ®', desc: 'ŸÖŸÜÿßŸÇÿ¥ÿ© ÿßŸÑÿ£ŸÑÿπÿßÿ® ŸàÿßŸÑÿ£ÿ≠ÿØÿßÿ´', limit: 200, users: [], isPublic: true },
                { id: 4, name: 'ÿßŸÑÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿß', desc: 'ÿ£ÿ≠ÿØÿ´ ÿßŸÑÿ™ŸÇŸÜŸäÿßÿ™ ŸàÿßŸÑÿ®ÿ±ŸÖÿ¨ÿ©', limit: 150, users: [], isPublic: true },
                { id: 5, name: 'VIP', desc: 'ÿ∫ÿ±ŸÅÿ© ÿÆÿßÿµÿ© ŸÑŸÑÿ£ÿπÿ∂ÿßÿ° ÿßŸÑŸÖŸÖŸäÿ≤ŸäŸÜ', limit: 50, users: [], isPublic: false, vipCode: '1218' }
            ],
            messages: [],
            pmMessages: [],
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿßŸÑŸÉ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä
            ownerAccount: {
                id: 'owner-001',
                username: 'mvnnooo',
                password: 'mmmmnnnn11',
                avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=mvnnooo&backgroundColor=dc2626',
                role: 'owner',
                verified: true,
                xp: 50000,
                donates: 10000,
                gender: 'male',
                joinDate: new Date().toISOString()
            },
            
            // ÿ™ŸáŸäÿ¶ÿ© ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            init() {
                // ÿ•ÿ∂ÿßŸÅÿ© ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿßŸÑŸÉ ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ŸÖŸàÿ¨ŸàÿØÿßŸã
                if (!this.users.some(u => u.id === 'owner-001')) {
                    this.users.push({...this.ownerAccount});
                }
                
                // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖŸÜ localStorage ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ŸÖŸàÿ¨ŸàÿØÿ©
                const savedUsers = localStorage.getItem('circl_users');
                if (savedUsers) {
                    const parsedUsers = JSON.parse(savedUsers);
                    // ÿØŸÖÿ¨ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏ŸäŸÜ ŸÖÿπ ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿßŸÑŸÉ
                    this.users = [...parsedUsers.filter(u => u.id !== 'owner-001'), ...this.users];
                }
                
                const savedRooms = localStorage.getItem('circl_rooms');
                if (savedRooms) {
                    this.rooms = JSON.parse(savedRooms);
                }
                
                const savedMessages = localStorage.getItem('circl_messages');
                if (savedMessages) {
                    this.messages = JSON.parse(savedMessages);
                }
                
                const savedPMMessages = localStorage.getItem('circl_pm_messages');
                if (savedPMMessages) {
                    this.pmMessages = JSON.parse(savedPMMessages);
                }
            },
            
            // ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÅŸä localStorage
            save() {
                localStorage.setItem('circl_users', JSON.stringify(this.users));
                localStorage.setItem('circl_rooms', JSON.stringify(this.rooms));
                localStorage.setItem('circl_messages', JSON.stringify(this.messages));
                localStorage.setItem('circl_pm_messages', JSON.stringify(this.pmMessages));
            },
            
            // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ¨ÿØŸäÿØ
            addUser(user) {
                const existingUser = this.users.find(u => u.username === user.username);
                if (existingUser) {
                    return { success: false, message: 'ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸàÿ¨ŸàÿØ ÿ®ÿßŸÑŸÅÿπŸÑ' };
                }
                
                this.users.push(user);
                this.save();
                return { success: true, user };
            },
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖÿ≥ÿ™ÿÆÿØŸÖ
            findUser(username) {
                return this.users.find(u => u.username === username);
            },
            
            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ
            authenticate(username, password) {
                if (username === this.ownerAccount.username && password === this.ownerAccount.password) {
                    return { success: true, user: {...this.ownerAccount} };
                }
                
                const user = this.users.find(u => u.username === username && u.password === password);
                if (user) {
                    return { success: true, user: {...user} };
                }
                
                return { success: false, message: 'ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ£Ÿà ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿ©' };
            },
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ
            updateUser(userId, updates) {
                const userIndex = this.users.findIndex(u => u.id === userId);
                if (userIndex !== -1) {
                    this.users[userIndex] = {...this.users[userIndex], ...updates};
                    this.save();
                    return { success: true, user: this.users[userIndex] };
                }
                return { success: false, message: 'ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ' };
            },
            
            // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ•ŸÑŸâ ÿ∫ÿ±ŸÅÿ©
            addUserToRoom(userId, roomId) {
                const room = this.rooms.find(r => r.id === roomId);
                if (!room) return false;
                
                // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÖÿß ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸàÿ¨ŸàÿØÿßŸã ÿ®ÿßŸÑŸÅÿπŸÑ ŸÅŸä ÿßŸÑÿ∫ÿ±ŸÅÿ©
                if (!room.users.includes(userId)) {
                    room.users.push(userId);
                    this.save();
                    return true;
                }
                return false;
            },
            
            // ÿ•ÿ≤ÿßŸÑÿ© ŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸÜ ÿ∫ÿ±ŸÅÿ©
            removeUserFromRoom(userId, roomId) {
                const room = this.rooms.find(r => r.id === roomId);
                if (!room) return false;
                
                const userIndex = room.users.indexOf(userId);
                if (userIndex !== -1) {
                    room.users.splice(userIndex, 1);
                    this.save();
                    return true;
                }
                return false;
            },
            
            // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿπÿØÿØ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ŸÅŸä ÿßŸÑÿ∫ÿ±ŸÅÿ©
            getRoomUsersCount(roomId) {
                const room = this.rooms.find(r => r.id === roomId);
                return room ? room.users.length : 0;
            },
            
            // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ŸÅŸä ÿßŸÑÿ∫ÿ±ŸÅÿ©
            getRoomUsers(roomId) {
                const room = this.rooms.find(r => r.id === roomId);
                if (!room) return [];
                
                return room.users.map(userId => {
                    return this.users.find(u => u.id === userId);
                }).filter(user => user);
            },
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿ≥ÿßŸÑÿ©
            addMessage(message) {
                this.messages.push(message);
                this.save();
                return message;
            },
            
            // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ∫ÿ±ŸÅÿ©
            getRoomMessages(roomId) {
                return this.messages.filter(m => m.roomId === roomId).slice(-50);
            },
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿ≥ÿßŸÑÿ© ÿÆÿßÿµÿ©
            addPMMessage(message) {
                this.pmMessages.push(message);
                this.save();
                return message;
            },
            
            // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿÆÿßÿµÿ© ÿ®ŸäŸÜ ŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ
            getPMMessages(userId1, userId2) {
                return this.pmMessages.filter(m => 
                    (m.senderId === userId1 && m.recipientId === userId2) ||
                    (m.senderId === userId2 && m.recipientId === userId1)
                ).slice(-50);
            }
        };

        // ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
        document.addEventListener('DOMContentLoaded', function() {
            // ÿ™ŸáŸäÿ¶ÿ© ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            DATABASE.init();
            
            // ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿπÿßŸÖÿ©
            let currentUser = null;
            let currentRoom = null;
            let currentRoomId = 1;
            let typingTimeout;
            const typingUsers = new Set();
            let isInVoiceCall = false;
            let isInVideoCall = false;
            let callStartTime = null;
            let callTimerInterval = null;
            let socket = null;
            
            // ÿπŸÜÿßÿµÿ± DOM
            const loginOverlay = document.getElementById('loginOverlay');
            const chatContainer = document.getElementById('chatContainer');
            const usernameInput = document.getElementById('usernameInput');
            const joinBtn = document.getElementById('joinBtn');
            const avatarOptions = document.querySelectorAll('.avatar-option');
            const userDisplayName = document.getElementById('userDisplayName');
            const userAvatar = document.getElementById('userAvatar');
            const userAvatarImg = document.getElementById('userAvatarImg');
            const userRole = document.getElementById('userRole');
            const messagesContainer = document.getElementById('messagesContainer');
            const messageInput = document.getElementById('messageInput');
            const sendBtn = document.getElementById('sendBtn');
            const roomList = document.getElementById('roomList');
            const userList = document.getElementById('userList');
            const onlineCount = document.getElementById('onlineCount');
            const totalUsersCount = document.getElementById('totalUsersCount');
            const roomUsersCount = document.getElementById('roomUsersCount');
            const currentRoomTitle = document.getElementById('currentRoomTitle');
            const currentRoomDesc = document.getElementById('currentRoomDesc');
            const typingIndicator = document.getElementById('typingIndicator');
            const typingText = document.getElementById('typingText');
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebar = document.querySelector('.sidebar');
            const storeBtn = document.getElementById('storeBtn');
            const storeOverlay = document.getElementById('storeOverlay');
            const googleBtn = document.getElementById('googleBtn');
            const facebookBtn = document.getElementById('facebookBtn');
            const verifiedBadge = document.getElementById('verifiedBadge');
            const vipOverlay = document.getElementById('vipOverlay');
            const vipCodeInput = document.getElementById('vipCode');
            const vipEnterBtn = document.getElementById('vipEnterBtn');
            const vipCancelBtn = document.getElementById('vipCancelBtn');
            const adOverlay = document.getElementById('adOverlay');
            const adTitle = document.getElementById('adTitle');
            const adText = document.getElementById('adText');
            const adBtn = document.getElementById('adBtn');
            const voiceCallBtn = document.getElementById('voiceCallBtn');
            const videoCallBtn = document.getElementById('videoCallBtn');
            const callIndicator = document.getElementById('callIndicator');
            const callTimer = document.getElementById('callTimer');
            const muteBtn = document.getElementById('muteBtn');
            const endCallBtn = document.getElementById('endCallBtn');
            const pmOverlay = document.getElementById('pmOverlay');
            const pmCloseBtn = document.getElementById('pmCloseBtn');
            const pmMessages = document.getElementById('pmMessages');
            const pmInput = document.getElementById('pmInput');
            const pmSendBtn = document.getElementById('pmSendBtn');
            const pmAvatar = document.getElementById('pmAvatar');
            const pmUsername = document.getElementById('pmUsername');
            const pmStatus = document.getElementById('pmStatus');
            
            // ÿπŸÜÿßÿµÿ± ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ
            const userLevel = document.getElementById('userLevel');
            const rankBadge = document.getElementById('rankBadge');
            const rankIcon = document.getElementById('rankIcon');
            const levelProgress = document.getElementById('levelProgress');
            const currentXP = document.getElementById('currentXP');
            const nextLevelXP = document.getElementById('nextLevelXP');
            
            // ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿµŸàÿ±ÿ© ÿßŸÑÿ¥ÿÆÿµŸäÿ©
            let selectedAvatar = 1;
            avatarOptions.forEach(option => {
                option.addEventListener('click', () => {
                    avatarOptions.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    selectedAvatar = option.getAttribute('data-avatar');
                });
            });
            
            // ÿ±ÿ®ÿ∑ ÿ≠ÿ≥ÿßÿ®ÿßÿ™ ÿßŸÑÿ™ŸàÿßÿµŸÑ ÿßŸÑÿßÿ¨ÿ™ŸÖÿßÿπŸä (ŸÖÿ≠ÿßŸÉÿßÿ©)
            googleBtn.addEventListener('click', () => {
                showNotification('ÿ¨ÿßÿ±Ÿç ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿ≠ÿ≥ÿßÿ® Google...', 'info');
                // ŸÅŸä ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿå ÿ≥Ÿäÿ™ŸÖ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ Firebase Authentication ÿ£Ÿà OAuth
                setTimeout(() => {
                    currentUser = {
                        ...currentUser,
                        verified: true,
                        socialAccounts: ['google']
                    };
                    googleBtn.innerHTML = '<i class="fas fa-check"></i> ÿ™ŸÖ ÿßŸÑÿ±ÿ®ÿ∑';
                    googleBtn.disabled = true;
                    googleBtn.style.background = '#10b981';
                    showNotification('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ ÿ≠ÿ≥ÿßÿ® Google ÿ®ŸÜÿ¨ÿßÿ≠!', 'success');
                }, 1500);
            });
            
            facebookBtn.addEventListener('click', () => {
                showNotification('ÿ¨ÿßÿ±Ÿç ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿ≠ÿ≥ÿßÿ® Facebook...', 'info');
                setTimeout(() => {
                    currentUser = {
                        ...currentUser,
                        verified: true,
                        socialAccounts: ['facebook']
                    };
                    facebookBtn.innerHTML = '<i class="fas fa-check"></i> ÿ™ŸÖ ÿßŸÑÿ±ÿ®ÿ∑';
                    facebookBtn.disabled = true;
                    facebookBtn.style.background = '#10b981';
                    showNotification('‚úÖ ÿ™ŸÖ ÿ±ÿ®ÿ∑ ÿ≠ÿ≥ÿßÿ® Facebook ÿ®ŸÜÿ¨ÿßÿ≠!', 'success');
                }, 1500);
            });
            
            // ÿßŸÑÿØÿÆŸàŸÑ ÿ•ŸÑŸâ ÿßŸÑÿØÿ±ÿØÿ¥ÿ©
            joinBtn.addEventListener('click', joinChat);
            usernameInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') joinChat();
            });
            
            function joinChat() {
                const username = usernameInput.value.trim();
                if (!username) {
                    usernameInput.style.borderColor = '#ef4444';
                    setTimeout(() => usernameInput.style.borderColor = '#e5e7eb', 2000);
                    showNotification('Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ÿßÿ≥ŸÖ ŸÖÿ≥ÿ™ÿÆÿØŸÖ', 'error');
                    return;
                }
                
                // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÖÿß ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸáŸà ÿßŸÑŸÖÿßŸÑŸÉ
                if (username === 'mvnnooo') {
                    showNotification('ÿ¨ÿßÿ±Ÿç ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ ÿßŸÑŸÖÿßŸÑŸÉ...', 'info');
                    // ŸÅŸä ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿå ÿ≥ŸäŸÉŸàŸÜ ŸáŸÜÿßŸÉ ŸÜŸÖŸàÿ∞ÿ¨ ŸÖŸÜŸÅÿµŸÑ ŸÑŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±
                    setTimeout(() => {
                        const authResult = DATABASE.authenticate('mvnnooo', 'mmmmnnnn11');
                        if (authResult.success) {
                            completeLogin(authResult.user);
                        }
                    }, 1000);
                    return;
                }
                
                // ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ÿßŸÑÿπÿßÿØŸäŸäŸÜÿå ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ® ÿ¨ÿØŸäÿØ
                const userId = 'user-' + Date.now();
                const newUser = {
                    id: userId,
                    username: username,
                    avatar: `https://api.dicebear.com/7.x/avataaars/svg?seed=${username}${selectedAvatar}&backgroundColor=6366f1`,
                    role: 'user',
                    verified: false,
                    xp: 100,
                    donates: 0,
                    gender: Math.random() > 0.5 ? 'male' : 'female',
                    joinDate: new Date().toISOString(),
                    socialAccounts: []
                };
                
                const result = DATABASE.addUser(newUser);
                if (result.success) {
                    completeLogin(result.user);
                } else {
                    showNotification(result.message, 'error');
                }
            }
            
            function completeLogin(user) {
                currentUser = user;
                
                // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ
                updateLevelInfo();
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
                userDisplayName.textContent = currentUser.username;
                userAvatarImg.src = currentUser.avatar;
                userRole.textContent = getRoleText(currentUser.role);
                userRole.className = `user-role role-${currentUser.role}`;
                
                if (currentUser.verified) {
                    verifiedBadge.style.display = 'inline-block';
                    userAvatar.style.borderColor = '#3b82f6';
                } else {
                    userAvatar.style.borderColor = getRankColor(currentUser.rankInfo.rankColor);
                }
                
                // ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ± (ŸÖÿ≠ÿßŸÉÿßÿ©)
                connectToServer();
                
                // ÿ•ÿÆŸÅÿßÿ° ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿØÿÆŸàŸÑ
                loginOverlay.style.opacity = '0';
                setTimeout(() => {
                    loginOverlay.style.display = 'none';
                    chatContainer.style.display = 'flex';
                    showNotification(`ŸÖÿ±ÿ≠ÿ®ÿßŸã ${currentUser.username}!`, 'success');
                    
                    // ÿØÿÆŸàŸÑ ÿßŸÑÿ∫ÿ±ŸÅÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
                    joinRoom(1);
                }, 300);
            }
            
            function getRoleText(role) {
                const roles = {
                    'owner': 'ŸÖÿßŸÑŸÉ',
                    'admin': 'ŸÖÿ¥ÿ±ŸÅ',
                    'moderator': 'ŸÖÿ±ÿßŸÇÿ®',
                    'vip': 'ÿπÿ∂Ÿà VIP',
                    'user': 'ŸÖÿ≥ÿ™ÿÆÿØŸÖ'
                };
                return roles[role] || 'ÿ≤ÿßÿ¶ÿ±';
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ
            function updateLevelInfo() {
                currentUser.rankInfo = LEVEL_SYSTEM.getRankInfo(currentUser.xp, currentUser.gender);
                
                userLevel.textContent = currentUser.rankInfo.level;
                rankBadge.textContent = currentUser.rankInfo.rank;
                rankBadge.className = `rank-badge ${currentUser.rankInfo.rankColor}`;
                
                rankIcon.className = `fas ${currentUser.rankInfo.rankIcon}`;
                rankIcon.style.color = getRankColor(currentUser.rankInfo.rankColor);
                rankIcon.style.display = currentUser.rankInfo.rank !== 'ŸÖÿ®ÿ™ÿØÿ¶' ? 'block' : 'none';
                
                levelProgress.style.width = `${currentUser.rankInfo.progress}%`;
                currentXP.textContent = `${currentUser.xp} XP`;
                nextLevelXP.textContent = `${currentUser.rankInfo.nextLevelXP} XP ŸÑŸÑŸàÿµŸàŸÑ ŸÑŸÑŸÖÿ≥ÿ™ŸàŸâ ${currentUser.rankInfo.level + 1}`;
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ™ÿßÿ¨ ŸÑŸÑÿ±ÿ™ÿ® ÿßŸÑÿπÿßŸÑŸäÿ©
                updateAvatarBadges();
            }
            
            function updateAvatarBadges() {
                // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ±ŸÖŸàÿ≤ ÿßŸÑŸÇÿØŸäŸÖÿ©
                document.querySelectorAll('.crown-badge, .shield-badge, .star-badge').forEach(el => el.remove());
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿ±ŸÖŸàÿ≤ ÿ≠ÿ≥ÿ® ÿßŸÑÿ±ÿ™ÿ®ÿ©
                const avatar = document.getElementById('userAvatar');
                if (currentUser.rankInfo.rank === 'ŸÉŸäŸÜÿ¨' || currentUser.rankInfo.rank === 'ŸÉŸàŸäŸÜ') {
                    const crown = document.createElement('div');
                    crown.className = 'crown-badge';
                    crown.innerHTML = '<i class="fas fa-crown"></i>';
                    avatar.appendChild(crown);
                } else if (currentUser.rankInfo.rank === 'ŸÖÿßÿ≥Ÿä') {
                    const shield = document.createElement('div');
                    shield.className = 'shield-badge';
                    shield.innerHTML = '<i class="fas fa-gem"></i>';
                    avatar.appendChild(shield);
                } else if (currentUser.rankInfo.rank === 'ÿ∞Ÿáÿ®Ÿä') {
                    const star = document.createElement('div');
                    star.className = 'star-badge';
                    star.innerHTML = '<i class="fas fa-star"></i>';
                    avatar.appendChild(star);
                }
            }
            
            function getRankColor(rankColor) {
                const colors = {
                    'beginner': '#6b7280',
                    'bronze': 'var(--bronze)',
                    'silver': 'var(--silver)',
                    'gold': 'var(--gold)',
                    'diamond': 'var(--diamond)',
                    'king': 'var(--king)',
                    'queen': 'var(--queen)'
                };
                return colors[rankColor] || '#6b7280';
            }
            
            // ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿÆÿßÿØŸÖ WebSocket (ŸÖÿ≠ÿßŸÉÿßÿ©)
            function connectToServer() {
                showNotification('ÿ¨ÿßÿ±Ÿç ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ±...', 'info');
                
                // ŸÖÿ≠ÿßŸÉÿßÿ© ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿßŸÑŸÜÿßÿ¨ÿ≠
                setTimeout(() => {
                    showNotification('‚úÖ ÿ™ŸÖ ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ± ÿ®ŸÜÿ¨ÿßÿ≠!', 'success');
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ∫ÿ±ŸÅ
                    updateRoomList();
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ
                    updateUserList();
                    
                    // ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿ≥ÿßŸÑÿ© ÿ™ÿ±ÿ≠Ÿäÿ®
                    addSystemMessage(`ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ŸÉ ŸÅŸä Circl Chatÿå ${currentUser.username}!`);
                    
                    // ÿ•ÿ∂ÿßŸÅÿ© XP ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ
                    addXP(50);
                }, 1000);
            }
            
            // ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ©
            sendBtn.addEventListener('click', sendMessage);
            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            function sendMessage() {
                const text = messageInput.value.trim();
                if (!text || !currentUser) return;
                
                const message = {
                    id: 'msg-' + Date.now(),
                    userId: currentUser.id,
                    username: currentUser.username,
                    avatar: currentUser.avatar,
                    text: text,
                    timestamp: new Date().toISOString(),
                    roomId: currentRoomId,
                    rank: currentUser.rankInfo.rank,
                    rankColor: currentUser.rankInfo.rankColor,
                    verified: currentUser.verified,
                    role: currentUser.role
                };
                
                // ÿ≠ŸÅÿ∏ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© ŸÅŸä ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                DATABASE.addMessage(message);
                
                // ÿπÿ±ÿ∂ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©
                addMessage(message);
                
                // ŸÖÿ≥ÿ≠ ÿ≠ŸÇŸÑ ÿßŸÑÿ•ÿØÿÆÿßŸÑ
                messageInput.value = '';
                
                // ÿ•ÿ∂ÿßŸÅÿ© XP
                addXP(5);
                
                // ŸÖÿ≠ÿßŸÉÿßÿ© ÿ±ÿØŸàÿØ ÿßŸÑÿ¢ÿÆÿ±ŸäŸÜ
                simulateResponses();
            }
            
            function simulateResponses() {
                if (Math.random() > 0.7 && DATABASE.getRoomUsers(currentRoomId).length > 1) {
                    setTimeout(() => {
                        const responses = [
                            'ÿ£ŸáŸÑÿßŸã! ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉÿü',
                            'ÿ±ÿ≥ÿßŸÑÿ© ÿ¨ŸÖŸäŸÑÿ©!',
                            'ÿ¥ŸÉÿ±ÿßŸã ŸÑŸÑŸÖÿ¥ÿßÿ±ŸÉÿ©',
                            'ÿ£ŸàÿßŸÅŸÇŸÉ ÿßŸÑÿ±ÿ£Ÿä',
                            'ŸÖÿπŸÑŸàŸÖÿßÿ™ ŸÖŸÅŸäÿØÿ©ÿå ÿ¥ŸÉÿ±ÿßŸã ŸÑŸÉ',
                            'üòä ÿ£ÿ≠ÿ® Ÿáÿ∞ÿß ÿßŸÑŸÜŸÇÿßÿ¥',
                            'ŸáŸÑ ŸÑÿØŸâ ÿ£ÿ≠ÿØ ÿ™ÿ¨ÿ±ÿ®ÿ© ŸÖÿπ Ÿáÿ∞ÿß ÿßŸÑŸÖŸàÿ∂Ÿàÿπÿü',
                            'ÿ£ÿ∂ŸÅŸÜŸä ÿπŸÑŸâ Ÿàÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ™ŸàÿßÿµŸÑ ÿ•ÿ∞ÿß ÿ£ÿ±ÿØÿ™'
                        ];
                        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                        
                        const roomUsers = DATABASE.getRoomUsers(currentRoomId);
                        const otherUsers = roomUsers.filter(u => u.id !== currentUser.id);
                        
                        if (otherUsers.length > 0) {
                            const randomUser = otherUsers[Math.floor(Math.random() * otherUsers.length)];
                            const userRankInfo = LEVEL_SYSTEM.getRankInfo(randomUser.xp, randomUser.gender);
                            
                            const botMessage = {
                                id: 'msg-' + Date.now(),
                                userId: randomUser.id,
                                username: randomUser.username,
                                avatar: randomUser.avatar,
                                text: randomResponse,
                                timestamp: new Date().toISOString(),
                                roomId: currentRoomId,
                                rank: userRankInfo.rank,
                                rankColor: userRankInfo.rankColor,
                                verified: randomUser.verified,
                                role: randomUser.role
                            };
                            
                            DATABASE.addMessage(botMessage);
                            addMessage(botMessage);
                        }
                    }, 1000 + Math.random() * 3000);
                }
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ∫ÿ±ŸÅ
            function updateRoomList() {
                roomList.innerHTML = '';
                
                DATABASE.rooms.forEach(room => {
                    const usersCount = DATABASE.getRoomUsersCount(room.id);
                    const isFull = usersCount >= room.limit;
                    const isActive = room.id === currentRoomId;
                    const isVipRoom = !room.isPublic;
                    
                    const li = document.createElement('li');
                    li.className = `room-item ${isActive ? 'active' : ''} ${isFull ? 'room-full' : ''} ${room.featured ? 'featured-room' : ''} ${isVipRoom ? 'room-vip' : ''}`;
                    li.dataset.roomId = room.id;
                    
                    li.innerHTML = `
                        <i class="fas ${isVipRoom ? 'fa-crown' : 'fa-hashtag'} room-icon"></i>
                        <div class="room-info">
                            <div class="room-name">
                                ${room.name}
                                ${isVipRoom ? '<span style="color: var(--vip);"><i class="fas fa-lock"></i></span>' : ''}
                            </div>
                            <div class="room-stats">
                                <span class="room-user-count">
                                    <i class="fas fa-users"></i> ${usersCount}/${room.limit}
                                </span>
                                ${room.featured ? '<span style="color: var(--gold);"><i class="fas fa-star"></i> ŸÖŸÖŸäÿ≤ÿ©</span>' : ''}
                                ${isVipRoom ? '<span style="color: var(--vip);"><i class="fas fa-crown"></i> VIP</span>' : ''}
                            </div>
                        </div>
                        ${isFull ? '<span class="room-limit"><i class="fas fa-lock"></i> ŸÖŸÖÿ™ŸÑÿ¶ÿ©</span>' : 
                          `<span class="room-limit">${room.limit} ÿ≠ÿØ</span>`}
                    `;
                    
                    li.addEventListener('click', () => {
                        if (room.id !== currentRoomId) {
                            if (isFull) {
                                showNotification('üö´ ÿßŸÑÿ∫ÿ±ŸÅÿ© ŸÖŸÖÿ™ŸÑÿ¶ÿ©! ÿ≠ÿßŸàŸÑ ŸÑÿßÿ≠ŸÇÿßŸã', 'error');
                                return;
                            }
                            
                            if (isVipRoom) {
                                showVIPRoomPrompt(room);
                            } else {
                                changeRoom(room.id, room.name);
                            }
                        }
                    });
                    
                    roomList.appendChild(li);
                });
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿπÿØÿØ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ŸÑŸÑÿ∫ÿ±ŸÅ
                document.getElementById('totalRoomsCount').textContent = DATABASE.rooms.length;
            }
            
            function showVIPRoomPrompt(room) {
                vipOverlay.style.display = 'flex';
                vipCodeInput.value = '';
                vipCodeInput.focus();
                
                const enterVip = () => {
                    if (vipCodeInput.value === room.vipCode) {
                        changeRoom(room.id, room.name);
                        vipOverlay.style.display = 'none';
                        showNotification('‚úÖ ÿ™ŸÖ ÿßŸÑÿØÿÆŸàŸÑ ÿ•ŸÑŸâ ÿ∫ÿ±ŸÅÿ© VIP ÿ®ŸÜÿ¨ÿßÿ≠!', 'success');
                    } else {
                        showNotification('‚ùå ÿ±ŸÖÿ≤ ÿßŸÑÿØÿÆŸàŸÑ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠', 'error');
                        vipCodeInput.focus();
                    }
                };
                
                vipEnterBtn.onclick = enterVip;
                vipCodeInput.onkeypress = (e) => {
                    if (e.key === 'Enter') enterVip();
                };
                
                vipCancelBtn.onclick = () => {
                    vipOverlay.style.display = 'none';
                };
            }
            
            function changeRoom(newRoomId, roomName) {
                const oldRoomId = currentRoomId;
                const oldRoom = DATABASE.rooms.find(r => r.id === oldRoomId);
                const newRoom = DATABASE.rooms.find(r => r.id === newRoomId);
                
                if (!newRoom) return;
                
                // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÅŸä ÿ∫ÿ±ŸÅÿ© ÿ≠ÿßŸÑŸäÿßŸãÿå ÿ£ÿ∏Ÿáÿ± ÿ•ÿπŸÑÿßŸÜ ŸÖÿ∫ÿßÿØÿ±ÿ©
                if (oldRoom && currentUser) {
                    showAd(`ŸÖÿ∫ÿßÿØÿ±ÿ© ÿ∫ÿ±ŸÅÿ© ${oldRoom.name}`, `ÿ£ŸÜÿ™ ÿπŸÑŸâ Ÿàÿ¥ŸÉ ŸÖÿ∫ÿßÿØÿ±ÿ© ÿ∫ÿ±ŸÅÿ© "${oldRoom.name}" ŸàÿßŸÑÿßŸÜÿ∂ŸÖÿßŸÖ ÿ•ŸÑŸâ "${roomName}".`);
                }
                
                // ÿ®ÿπÿØ ÿßŸÑÿ™ÿ£ŸÉŸäÿØÿå ŸÇŸÖ ÿ®ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿ∫ÿ±ŸÅÿ©
                adBtn.onclick = () => {
                    adOverlay.style.display = 'none';
                    
                    // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸÜ ÿßŸÑÿ∫ÿ±ŸÅÿ© ÿßŸÑŸÇÿØŸäŸÖÿ©
                    if (oldRoom) {
                        DATABASE.removeUserFromRoom(currentUser.id, oldRoomId);
                    }
                    
                    // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ•ŸÑŸâ ÿßŸÑÿ∫ÿ±ŸÅÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ©
                    DATABASE.addUserToRoom(currentUser.id, newRoomId);
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™
                    currentRoomId = newRoomId;
                    currentRoom = newRoom;
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑÿ∫ÿ±ŸÅ
                    updateRoomUI();
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ÿπŸÜŸàÿßŸÜ ÿßŸÑÿ∫ÿ±ŸÅÿ©
                    currentRoomTitle.textContent = newRoom.name;
                    currentRoomDesc.textContent = `${newRoom.desc} | ${DATABASE.getRoomUsersCount(newRoomId)} ŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖÿ™ÿµŸÑ`;
                    roomUsersCount.textContent = DATABASE.getRoomUsersCount(newRoomId);
                    
                    // ŸÖÿ≥ÿ≠ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑŸÇÿØŸäŸÖÿ©
                    clearMessages();
                    
                    // ÿ™ÿ≠ŸÖŸäŸÑ ÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ∫ÿ±ŸÅÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ©
                    loadRoomMessages();
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ
                    updateUserList();
                    
                    // ÿπÿ±ÿ∂ ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ
                    addSystemMessage(`üì¢ ÿßŸÜÿ™ŸÇŸÑÿ™ ŸÖŸÜ ÿ∫ÿ±ŸÅÿ© ${oldRoom ? oldRoom.name : 'ÿßŸÑÿ≥ÿßÿ®ŸÇÿ©'} ÿ•ŸÑŸâ ÿ∫ÿ±ŸÅÿ© ${newRoom.name}`);
                    
                    // ÿ•ÿ∂ÿßŸÅÿ© XP
                    addXP(10);
                    
                    // ÿ•ÿ∏Ÿáÿßÿ± ÿ•ÿπŸÑÿßŸÜ ÿ™ÿ±ÿ≠Ÿäÿ®Ÿä
                    setTimeout(() => {
                        showAd(`ÿ™ÿ±ÿ≠Ÿäÿ® ŸÅŸä ÿ∫ÿ±ŸÅÿ© ${newRoom.name}`, `ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ŸÉ ŸÅŸä ÿ∫ÿ±ŸÅÿ© "${newRoom.name}"! ÿßÿ≥ÿ™ŸÖÿ™ÿπ ÿ®ÿßŸÑŸÖÿ≠ÿßÿØÿ´ÿ© ŸÖÿπ ÿßŸÑÿ£ÿπÿ∂ÿßÿ°.`);
                    }, 500);
                };
            }
            
            function showAd(title, text) {
                adTitle.textContent = title;
                adText.textContent = text;
                adOverlay.style.display = 'flex';
            }
            
            // ÿßŸÑÿßŸÜÿ∂ŸÖÿßŸÖ ÿ•ŸÑŸâ ÿ∫ÿ±ŸÅÿ©
            function joinRoom(roomId) {
                const room = DATABASE.rooms.find(r => r.id === roomId);
                if (!room) return;
                
                currentRoomId = roomId;
                currentRoom = room;
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ•ŸÑŸâ ÿßŸÑÿ∫ÿ±ŸÅÿ©
                DATABASE.addUserToRoom(currentUser.id, roomId);
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
                updateRoomUI();
                currentRoomTitle.textContent = room.name;
                currentRoomDesc.textContent = `${room.desc} | ${DATABASE.getRoomUsersCount(roomId)} ŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖÿ™ÿµŸÑ`;
                roomUsersCount.textContent = DATABASE.getRoomUsersCount(roomId);
                
                // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ
                loadRoomMessages();
                
                // ÿ™ÿ≠ÿØŸäÿ´ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ
                updateUserList();
                
                // ÿ•ÿ∂ÿßŸÅÿ© XP
                addXP(5);
            }
            
            // ÿ™ÿ≠ŸÖŸäŸÑ ÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ∫ÿ±ŸÅÿ©
            function loadRoomMessages() {
                clearMessages();
                
                const messages = DATABASE.getRoomMessages(currentRoomId);
                messages.forEach(message => {
                    addMessage(message);
                });
                
                if (messages.length === 0) {
                    addSystemMessage('ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ±ÿ≥ÿßÿ¶ŸÑ ÿ≥ÿßÿ®ŸÇÿ© ŸÅŸä Ÿáÿ∞Ÿá ÿßŸÑÿ∫ÿ±ŸÅÿ©. ŸÉŸÜ ÿ£ŸàŸÑ ŸÖŸÜ Ÿäÿ±ÿ≥ŸÑ ÿ±ÿ≥ÿßŸÑÿ©!');
                }
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ
            function updateUserList() {
                userList.innerHTML = '';
                
                const roomUsers = DATABASE.getRoomUsers(currentRoomId);
                const onlineUsers = DATABASE.users.filter(u => u.id !== currentUser.id).slice(0, 20);
                const allUsers = [...roomUsers.filter(u => u.id !== currentUser.id), ...onlineUsers.filter(u => !roomUsers.some(ru => ru.id === u.id))];
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑÿ≠ÿßŸÑŸä ÿ£ŸàŸÑÿßŸã
                addUserToList(currentUser, true);
                
                // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ÿ¢ÿÆÿ±ŸäŸÜ
                allUsers.slice(0, 19).forEach(user => {
                    addUserToList(user, false);
                });
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™
                onlineCount.textContent = roomUsers.length;
                totalUsersCount.textContent = DATABASE.users.length;
            }
            
            function addUserToList(user, isCurrentUser) {
                const li = document.createElement('li');
                li.className = 'user-list-item';
                li.dataset.userId = user.id;
                
                const userRankInfo = LEVEL_SYSTEM.getRankInfo(user.xp, user.gender);
                const rankColor = userRankInfo.rankColor;
                
                li.innerHTML = `
                    <div class="user-list-avatar" style="border-color: ${getRankColor(rankColor)}">
                        <img src="${user.avatar}" alt="${user.username}" title="ÿßŸÜŸÇÿ± ŸÑŸÅÿ™ÿ≠ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿÆÿßÿµÿ©">
                        <div class="user-rank-indicator ${rankColor}">
                            <i class="fas ${userRankInfo.rankIcon}"></i>
                        </div>
                    </div>
                    <div class="user-list-info">
                        <div class="user-list-name">
                            ${isCurrentUser ? '<span class="owner-badge">ÿ£ŸÜÿß</span>' : ''}
                            ${user.role === 'owner' ? '<span class="owner-badge">OWNER</span>' : ''}
                            ${user.role === 'admin' ? '<span class="admin-badge">ADMIN</span>' : ''}
                            ${user.role === 'moderator' ? '<span class="moderator-badge">MOD</span>' : ''}
                            ${user.role === 'vip' ? '<span class="vip-badge">VIP</span>' : ''}
                            <span title="${user.username}">${user.username.length > 15 ? user.username.substring(0, 12) + '...' : user.username}</span>
                            ${user.verified ? '<i class="fas fa-check-circle verified-badge" title="ÿ≠ÿ≥ÿßÿ® ŸÖŸàÿ´ŸÇ"></i>' : ''}
                        </div>
                        <div class="user-list-status">
                            <span>${userRankInfo.rank}</span>
                            <div class="user-list-dot"></div>
                            <span>${isCurrentUser ? 'ÿ£ŸÜÿ™' : 'ŸÖÿ™ÿµŸÑ'}</span>
                        </div>
                    </div>
                `;
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿ≠ÿØÿ´ ÿßŸÑŸÜŸÇÿ± ŸÑŸÅÿ™ÿ≠ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿÆÿßÿµÿ© (ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ÿßŸÑÿ¢ÿÆÿ±ŸäŸÜ ŸÅŸÇÿ∑)
                if (!isCurrentUser) {
                    li.addEventListener('click', () => {
                        openPrivateChat(user);
                    });
                    li.style.cursor = 'pointer';
                }
                
                userList.appendChild(li);
            }
            
            function openPrivateChat(user) {
                pmAvatar.src = user.avatar;
                pmUsername.textContent = user.username;
                pmOverlay.style.display = 'flex';
                pmInput.focus();
                
                // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿÆÿßÿµÿ©
                loadPMMessages(user.id);
                
                // ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ© ÿÆÿßÿµÿ©
                pmSendBtn.onclick = () => sendPrivateMessage(user.id);
                pmInput.onkeypress = (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendPrivateMessage(user.id);
                    }
                };
            }
            
            function loadPMMessages(otherUserId) {
                pmMessages.innerHTML = '';
                
                const messages = DATABASE.getPMMessages(currentUser.id, otherUserId);
                if (messages.length === 0) {
                    pmMessages.innerHTML = '<div style="text-align: center; padding: 2rem; color: #6b7280;">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ±ÿ≥ÿßÿ¶ŸÑ ÿÆÿßÿµÿ© ÿ®ÿπÿØ. ÿßÿ®ÿØÿ£ ÿßŸÑŸÖÿ≠ÿßÿØÿ´ÿ©!</div>';
                } else {
                    messages.forEach(message => {
                        addPMMessageToUI(message);
                    });
                    pmMessages.scrollTop = pmMessages.scrollHeight;
                }
            }
            
            function sendPrivateMessage(recipientId) {
                const text = pmInput.value.trim();
                if (!text) return;
                
                const message = {
                    id: 'pm-' + Date.now(),
                    senderId: currentUser.id,
                    senderName: currentUser.username,
                    senderAvatar: currentUser.avatar,
                    recipientId: recipientId,
                    text: text,
                    timestamp: new Date().toISOString(),
                    read: false
                };
                
                DATABASE.addPMMessage(message);
                addPMMessageToUI(message);
                pmInput.value = '';
                pmMessages.scrollTop = pmMessages.scrollHeight;
                
                // ÿ•ÿ∂ÿßŸÅÿ© XP
                addXP(3);
            }
            
            function addPMMessageToUI(message) {
                const isCurrentUser = message.senderId === currentUser.id;
                const time = new Date(message.timestamp).toLocaleTimeString('ar-EG', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${isCurrentUser ? 'my-message' : ''}`;
                messageDiv.style.marginBottom = '1rem';
                
                messageDiv.innerHTML = `
                    ${!isCurrentUser ? `
                        <div class="message-avatar" style="border-color: #6b7280; width: 40px; height: 40px;">
                            <img src="${message.senderAvatar}" alt="${message.senderName}">
                        </div>
                    ` : ''}
                    <div class="message-content" style="max-width: 80%;">
                        <div class="message-header">
                            <div class="message-sender">
                                ${message.senderName}
                            </div>
                            <div class="message-time">${time}</div>
                        </div>
                        <div class="message-text">${escapeHtml(message.text)}</div>
                    </div>
                    ${isCurrentUser ? `
                        <div class="message-avatar" style="border-color: #6b7280; width: 40px; height: 40px;">
                            <img src="${currentUser.avatar}" alt="${currentUser.username}">
                        </div>
                    ` : ''}
                `;
                
                pmMessages.appendChild(messageDiv);
            }
            
            // ÿ•ÿ∫ŸÑÿßŸÇ ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿÆÿßÿµÿ©
            pmCloseBtn.addEventListener('click', () => {
                pmOverlay.style.display = 'none';
            });
            
            // ÿ™ÿ≠ÿØŸäÿ´ Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑÿ∫ÿ±ŸÅ
            function updateRoomUI() {
                const roomItems = document.querySelectorAll('.room-item');
                roomItems.forEach(item => {
                    const roomId = parseInt(item.dataset.roomId);
                    item.classList.toggle('active', roomId === currentRoomId);
                });
            }
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿ≥ÿßŸÑÿ© ÿ¨ÿØŸäÿØÿ©
            function addMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${message.userId === currentUser.id ? 'my-message' : ''}`;
                
                const time = new Date(message.timestamp).toLocaleTimeString('ar-EG', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const rankColor = message.rankColor || 'beginner';
                
                messageDiv.innerHTML = `
                    <div class="message-avatar" style="border-color: ${getRankColor(rankColor)}">
                        <img src="${message.avatar}" alt="${message.username}">
                        <div class="message-rank" style="color: ${getRankColor(rankColor)}">
                            <i class="fas ${LEVEL_SYSTEM.getRankIcon(message.rank)}"></i>
                        </div>
                    </div>
                    <div class="message-content">
                        <div class="message-header">
                            <div class="message-sender">
                                ${message.role === 'owner' ? '<span class="owner-badge">OWNER</span>' : ''}
                                ${message.role === 'admin' ? '<span class="admin-badge">ADMIN</span>' : ''}
                                ${message.role === 'moderator' ? '<span class="moderator-badge">MOD</span>' : ''}
                                ${message.role === 'vip' ? '<span class="vip-badge">VIP</span>' : ''}
                                <span>${message.username}</span>
                                ${message.verified ? '<i class="fas fa-check-circle verified-badge"></i>' : ''}
                                <span class="rank-badge ${rankColor}" style="font-size: 0.7rem; padding: 2px 6px;">${message.rank}</span>
                            </div>
                            <div class="message-time">${time}</div>
                        </div>
                        <div class="message-text">${escapeHtml(message.text)}</div>
                        <div class="message-actions">
                            <button class="message-action-btn" onclick="likeMessage('${message.id}')">
                                <i class="far fa-thumbs-up"></i> ÿ•ÿπÿ¨ÿßÿ®
                            </button>
                            <button class="message-action-btn" onclick="replyToMessage('${message.id}', '${message.username}')">
                                <i class="far fa-comment"></i> ÿ±ÿØ
                            </button>
                            <button class="message-action-btn" onclick="openPrivateChatFromMessage('${message.userId}', '${message.username}')">
                                <i class="fas fa-user"></i> ÿÆÿßÿµ
                            </button>
                        </div>
                    </div>
                `;
                
                // ÿ•ÿÆŸÅÿßÿ° ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑÿ™ÿ±ÿ≠Ÿäÿ® ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ŸÖŸàÿ¨ŸàÿØÿ©
                const welcomeMsg = document.querySelector('.welcome-message');
                if (welcomeMsg) welcomeMsg.style.display = 'none';
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©
                messagesContainer.appendChild(messageDiv);
                
                // ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ŸÑŸÑÿ£ÿ≥ŸÅŸÑ
                scrollToBottom();
            }
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿ≥ÿßŸÑÿ© ŸÜÿ∏ÿßŸÖ
            function addSystemMessage(text) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message-date';
                messageDiv.innerHTML = `<div class="date-line">${text}</div>`;
                
                messagesContainer.appendChild(messageDiv);
                scrollToBottom();
            }
            
            // ŸÖÿ≥ÿ≠ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ
            function clearMessages() {
                const messages = messagesContainer.querySelectorAll('.message, .message-date');
                messages.forEach(msg => {
                    if (!msg.classList.contains('welcome-message')) {
                        msg.remove();
                    }
                });
            }
            
            // ÿ•ÿ∂ÿßŸÅÿ© XP
            function addXP(amount) {
                if (!currentUser) return;
                
                currentUser.xp += amount;
                DATABASE.updateUser(currentUser.id, { xp: currentUser.xp });
                updateLevelInfo();
                
                // ÿπÿ±ÿ∂ ÿ•ÿ¥ÿπÿßÿ± ŸÑŸÑŸÖŸÉÿßÿ≥ÿ® ÿßŸÑŸÉÿ®Ÿäÿ±ÿ©
                if (amount >= 10) {
                    showNotification(`üéâ +${amount} XP! ÿ™ŸÇÿØŸÖ ŸÅŸä ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ`, 'success');
                }
            }
            
            // ÿπÿ±ÿ∂ ÿ•ÿ¥ÿπÿßÿ±
            function showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: ${type === 'error' ? '#ef4444' : type === 'success' ? '#10b981' : '#3b82f6'};
                    color: white;
                    padding: 15px 25px;
                    border-radius: var(--radius-lg);
                    z-index: 10000;
                    box-shadow: var(--shadow-lg);
                    animation: slideDown 0.3s ease;
                    font-family: 'Tajawal', sans-serif;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    max-width: 90%;
                    word-break: break-word;
                `;
                
                const icons = {
                    'info': 'fa-info-circle',
                    'success': 'fa-check-circle',
                    'error': 'fa-exclamation-circle',
                    'warning': 'fa-exclamation-triangle'
                };
                
                notification.innerHTML = `
                    <i class="fas ${icons[type] || 'fa-info-circle'}"></i>
                    <span>${message}</span>
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideUp 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿ£ŸÜŸäŸÖŸäÿ¥ŸÜ
                if (!document.querySelector('#notification-styles')) {
                    const style = document.createElement('style');
                    style.id = 'notification-styles';
                    style.textContent = `
                        @keyframes slideDown {
                            from { top: -100px; opacity: 0; }
                            to { top: 20px; opacity: 1; }
                        }
                        @keyframes slideUp {
                            from { top: 20px; opacity: 1; }
                            to { top: -100px; opacity: 0; }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }
            
            // ŸÅÿ™ÿ≠ ŸÖÿ™ÿ¨ÿ± ÿßŸÑÿØŸàŸÜÿßÿ™
            storeBtn.addEventListener('click', () => {
                storeOverlay.style.display = 'flex';
                loadDonateItems();
            });
            
            // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÖÿ™ÿ¨ÿ± ÿπŸÜÿØ ÿßŸÑŸÜŸÇÿ± ÿÆÿßÿ±ÿ¨ ÿßŸÑÿµŸÜÿØŸàŸÇ
            storeOverlay.addEventListener('click', (e) => {
                if (e.target === storeOverlay) {
                    storeOverlay.style.display = 'none';
                }
            });
            
            // ÿ™ÿ≠ŸÖŸäŸÑ ÿπŸÜÿßÿµÿ± ÿßŸÑŸÖÿ™ÿ¨ÿ±
            function loadDonateItems() {
                const donateItems = document.getElementById('donateItems');
                const items = [
                    { id: 1, name: '100 ÿØŸàŸÜÿßÿ™', price: 10, description: 'ŸÑŸÑŸÖÿ≤ÿßŸäÿß ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©', value: 100 },
                    { id: 2, name: '500 ÿØŸàŸÜÿßÿ™', price: 45, description: 'ÿ≠ÿ≤ŸÖÿ© ŸÖÿ™ŸÖŸäÿ≤ÿ©', value: 500, popular: true },
                    { id: 3, name: '1000 ÿØŸàŸÜÿßÿ™', price: 80, description: 'ÿ™ŸàŸÅŸäÿ± ŸÉÿ®Ÿäÿ±', value: 1000, best: true },
                    { id: 4, name: '2500 ÿØŸàŸÜÿßÿ™', price: 180, description: 'ÿ≠ÿ≤ŸÖÿ© VIP', value: 2500, vip: true },
                    { id: 5, name: '5000 ÿØŸàŸÜÿßÿ™', price: 350, description: 'ÿ≠ÿ≤ŸÖÿ© ÿßŸÑŸÖÿßÿ≥', value: 5000, diamond: true },
                    { id: 6, name: 'ÿπÿ∂ŸàŸäÿ© ÿ¥Ÿáÿ± VIP', price: 100, description: 'ÿπÿ∂ŸàŸäÿ© VIP ŸÑŸÖÿØÿ© ÿ¥Ÿáÿ±', value: 'vip' },
                    { id: 7, name: 'ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿßÿ≥ŸÖ', price: 50, description: 'ÿ™ÿ∫ŸäŸäÿ± ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖÿ±ÿ© Ÿàÿßÿ≠ÿØÿ©', value: 'name' },
                    { id: 8, name: 'ÿ•ÿ∑ÿßÿ±ÿßÿ™ ŸÖŸÖŸäÿ≤ÿ©', price: 30, description: '5 ÿ•ÿ∑ÿßÿ±ÿßÿ™ ŸÑŸÑÿµŸàÿ± ÿßŸÑÿ¥ÿÆÿµŸäÿ©', value: 'frames' },
                    { id: 9, name: 'ÿ±ŸÖŸàÿ≤ ÿÆÿßÿµÿ©', price: 20, description: 'ÿ±ŸÖŸàÿ≤ ŸÖŸÖŸäÿ≤ÿ© ÿ®ÿ¨ÿßŸÜÿ® ÿßŸÑÿßÿ≥ŸÖ', value: 'badges' }
                ];
                
                donateItems.innerHTML = items.map(item => `
                    <div class="donate-item">
                        <div>
                            <strong>${item.name}</strong>
                            <div style="font-size: 0.9rem; color: #6b7280;">${item.description}</div>
                            ${item.popular ? '<span style="color: var(--primary); font-size: 0.8rem;">‚≠ê ÿßŸÑÿ£ŸÉÿ´ÿ± ÿ¥ŸäŸàÿπÿßŸã</span>' : ''}
                            ${item.best ? '<span style="color: var(--gold); font-size: 0.8rem;">üèÜ ÿ£ŸÅÿ∂ŸÑ ŸÇŸäŸÖÿ©</span>' : ''}
                        </div>
                        <button class="donate-price" onclick="buyDonateItem(${item.id})">
                            ${item.price} ÿØŸàŸÑÿßÿ±
                        </button>
                    </div>
                `).join('');
                
                document.getElementById('donateBalance').textContent = currentUser.donates;
            }
            
            // ÿ¥ÿ±ÿßÿ° ÿπŸÜÿµÿ± ŸÖŸÜ ÿßŸÑŸÖÿ™ÿ¨ÿ±
            window.buyDonateItem = function(itemId) {
                const items = [
                    { id: 1, name: '100 ÿØŸàŸÜÿßÿ™', price: 10, value: 100 },
                    { id: 2, name: '500 ÿØŸàŸÜÿßÿ™', price: 45, value: 500 },
                    { id: 3, name: '1000 ÿØŸàŸÜÿßÿ™', price: 80, value: 1000 },
                    { id: 4, name: '2500 ÿØŸàŸÜÿßÿ™', price: 180, value: 2500 },
                    { id: 5, name: '5000 ÿØŸàŸÜÿßÿ™', price: 350, value: 5000 },
                    { id: 6, name: 'ÿπÿ∂ŸàŸäÿ© ÿ¥Ÿáÿ± VIP', price: 100, value: 'vip' },
                    { id: 7, name: 'ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿßÿ≥ŸÖ', price: 50, value: 'name' },
                    { id: 8, name: 'ÿ•ÿ∑ÿßÿ±ÿßÿ™ ŸÖŸÖŸäÿ≤ÿ©', price: 30, value: 'frames' },
                    { id: 9, name: 'ÿ±ŸÖŸàÿ≤ ÿÆÿßÿµÿ©', price: 20, value: 'badges' }
                ];
                
                const item = items.find(i => i.id === itemId);
                if (!item) return;
                
                if (confirm(`ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ¥ÿ±ÿßÿ° ${item.name} ÿ®ŸÄ ${item.price} ÿØŸàŸÑÿßÿ±ÿü`)) {
                    if (typeof item.value === 'number') {
                        currentUser.donates += item.value;
                        DATABASE.updateUser(currentUser.id, { donates: currentUser.donates });
                    } else if (item.value === 'vip') {
                        currentUser.role = 'vip';
                        DATABASE.updateUser(currentUser.id, { role: 'vip' });
                        userRole.textContent = getRoleText(currentUser.role);
                        userRole.className = `user-role role-${currentUser.role}`;
                    }
                    
                    showNotification(`üéÅ ÿ™ŸÖ ÿ¥ÿ±ÿßÿ° ${item.name}!`, 'success');
                    loadDonateItems();
                    
                    // ÿ•ÿ∂ÿßŸÅÿ© XP ŸÑŸÑÿ¥ÿ±ÿßÿ°
                    addXP(item.price * 10);
                }
            };
            
            // ÿßŸÑŸÖŸÉÿßŸÑŸÖÿßÿ™ ÿßŸÑÿµŸàÿ™Ÿäÿ© ŸàÿßŸÑŸÖÿ±ÿ¶Ÿäÿ©
            voiceCallBtn.addEventListener('click', () => {
                if (isInVoiceCall) {
                    endCall();
                } else {
                    startVoiceCall();
                }
            });
            
            videoCallBtn.addEventListener('click', () => {
                if (isInVideoCall) {
                    endCall();
                } else {
                    startVideoCall();
                }
            });
            
            function startVoiceCall() {
                isInVoiceCall = true;
                voiceCallBtn.classList.add('active');
                callStartTime = new Date();
                callIndicator.style.display = 'flex';
                callIndicator.querySelector('div:first-child div:first-child').textContent = 'ŸÖŸÉÿßŸÑŸÖÿ© ÿµŸàÿ™Ÿäÿ© ÿ¨ÿßÿ±Ÿäÿ©';
                
                startCallTimer();
                showNotification('üîä ÿ®ÿØÿ£ÿ™ ŸÖŸÉÿßŸÑŸÖÿ© ÿµŸàÿ™Ÿäÿ© ŸÅŸä ÿßŸÑÿ∫ÿ±ŸÅÿ©', 'info');
            }
            
            function startVideoCall() {
                isInVideoCall = true;
                videoCallBtn.classList.add('active');
                callStartTime = new Date();
                callIndicator.style.display = 'flex';
                callIndicator.querySelector('div:first-child div:first-child').textContent = 'ŸÖŸÉÿßŸÑŸÖÿ© ŸÅŸäÿØŸäŸà ÿ¨ÿßÿ±Ÿäÿ©';
                
                startCallTimer();
                showNotification('üìπ ÿ®ÿØÿ£ÿ™ ŸÖŸÉÿßŸÑŸÖÿ© ŸÅŸäÿØŸäŸà ŸÅŸä ÿßŸÑÿ∫ÿ±ŸÅÿ©', 'info');
            }
            
            function endCall() {
                isInVoiceCall = false;
                isInVideoCall = false;
                voiceCallBtn.classList.remove('active');
                videoCallBtn.classList.remove('active');
                callIndicator.style.display = 'none';
                
                if (callTimerInterval) {
                    clearInterval(callTimerInterval);
                    callTimerInterval = null;
                }
                
                showNotification('ÿ™ŸÖ ÿ•ŸÜŸáÿßÿ° ÿßŸÑŸÖŸÉÿßŸÑŸÖÿ©', 'info');
            }
            
            function startCallTimer() {
                callTimerInterval = setInterval(() => {
                    const now = new Date();
                    const diff = Math.floor((now - callStartTime) / 1000);
                    const minutes = Math.floor(diff / 60);
                    const seconds = diff % 60;
                    callTimer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            }
            
            endCallBtn.addEventListener('click', endCall);
            
            muteBtn.addEventListener('click', () => {
                muteBtn.innerHTML = muteBtn.innerHTML.includes('fa-microphone-slash') ? 
                    '<i class="fas fa-microphone"></i>' : 
                    '<i class="fas fa-microphone-slash"></i>';
                showNotification('ÿ™ŸÖ ÿ™ÿ∫ŸäŸäÿ± ÿ≠ÿßŸÑÿ© ÿßŸÑŸÖŸäŸÉÿ±ŸàŸÅŸàŸÜ', 'info');
            });
            
            // ÿ•ÿ∫ŸÑÿßŸÇ ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ•ÿπŸÑÿßŸÜ ÿπŸÜÿØ ÿßŸÑŸÜŸÇÿ± ÿÆÿßÿ±ÿ¨Ÿáÿß
            adOverlay.addEventListener('click', (e) => {
                if (e.target === adOverlay) {
                    adOverlay.style.display = 'none';
                }
            });
            
            vipOverlay.addEventListener('click', (e) => {
                if (e.target === vipOverlay) {
                    vipOverlay.style.display = 'none';
                }
            });
            
            // ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ© ŸÑŸÑÿ¨ŸàÿßŸÑ
            mobileMenuBtn.addEventListener('click', () => {
                sidebar.classList.toggle('active');
            });
            
            // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿπŸÜÿØ ÿßŸÑŸÜŸÇÿ± ÿÆÿßÿ±ÿ¨Ÿáÿß
            document.addEventListener('click', (e) => {
                if (window.innerWidth <= 768 && 
                    !sidebar.contains(e.target) && 
                    !mobileMenuBtn.contains(e.target)) {
                    sidebar.classList.remove('active');
                }
            });
            
            // ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ŸÑÿ¢ÿÆÿ± ÿ±ÿ≥ÿßŸÑÿ©
            function scrollToBottom() {
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            // ÿßŸÑŸáÿ±Ÿàÿ® ŸÖŸÜ HTML
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
            
            // Ÿàÿ∏ÿßÿ¶ŸÅ ŸÖÿ≥ÿßÿπÿØÿ© ŸÑŸÑÿ±ÿ≥ÿßÿ¶ŸÑ
            window.likeMessage = function(messageId) {
                showNotification('ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿ•ÿπÿ¨ÿßÿ® ŸÑŸÑÿ±ÿ≥ÿßŸÑÿ©', 'info');
                // ŸÅŸä ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿå ÿ≥Ÿäÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿπÿ¨ÿßÿ®ÿßÿ™ ŸÅŸä ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            };
            
            window.replyToMessage = function(messageId, username) {
                messageInput.value = `@${username} `;
                messageInput.focus();
                showNotification(`ÿ¨ÿßÿ±Ÿç ÿßŸÑÿ±ÿØ ÿπŸÑŸâ ${username}`, 'info');
            };
            
            window.openPrivateChatFromMessage = function(userId, username) {
                const user = DATABASE.users.find(u => u.id === userId);
                if (user) {
                    openPrivateChat(user);
                }
            };
            
            // ÿ•ÿ∂ÿßŸÅÿ© Ÿàÿ∏ÿßÿ¶ŸÅ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ£ÿÆÿ±Ÿâ
            const emojiBtn = document.getElementById('emojiBtn');
            const imageBtn = document.getElementById('imageBtn');
            const fileBtn = document.getElementById('fileBtn');
            const voiceBtn = document.getElementById('voiceBtn');
            
            emojiBtn.addEventListener('click', () => {
                showNotification('üöß ŸÇÿ±Ÿäÿ®ÿßŸã: ŸÖÿ™ÿµŸÅÿ≠ ÿßŸÑÿ™ÿπÿßÿ®Ÿäÿ±', 'info');
            });
            
            imageBtn.addEventListener('click', () => {
                // ŸÅŸä ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿå ÿ≥Ÿäÿ™ŸÖ ŸÅÿ™ÿ≠ ŸÖÿ≠ÿØÿØ ÿßŸÑŸÖŸÑŸÅÿßÿ™
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        showNotification(`ÿ™ŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ÿµŸàÿ±ÿ©: ${file.name} (ŸÖÿ≠ÿßŸÉÿßÿ©)`, 'info');
                        // ŸÅŸä ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿå ÿ≥Ÿäÿ™ŸÖ ÿ±ŸÅÿπ ÿßŸÑÿµŸàÿ±ÿ© ÿ•ŸÑŸâ ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ±
                    }
                };
                input.click();
            });
            
            fileBtn.addEventListener('click', () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        showNotification(`ÿ™ŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÑŸÅ: ${file.name} (ŸÖÿ≠ÿßŸÉÿßÿ©)`, 'info');
                        // ŸÅŸä ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿå ÿ≥Ÿäÿ™ŸÖ ÿ±ŸÅÿπ ÿßŸÑŸÖŸÑŸÅ ÿ•ŸÑŸâ ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ±
                    }
                };
                input.click();
            });
            
            voiceBtn.addEventListener('click', () => {
                showNotification('üé§ ÿßÿ∂ÿ∫ÿ∑ ŸÖÿπ ÿßŸÑÿßÿ≥ÿ™ŸÖÿ±ÿßÿ± ŸÑŸÑÿ™ÿ≥ÿ¨ŸäŸÑ (ŸÖÿ≠ÿßŸÉÿßÿ©)', 'info');
            });
            
            // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ≤ÿ±
            document.getElementById('settingsBtn').addEventListener('click', () => {
                showNotification('üöß ŸÇÿ±Ÿäÿ®ÿßŸã: ÿµŸÅÿ≠ÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™', 'info');
            });
            
            // ÿ≤ÿ± ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®
            document.getElementById('rankingBtn').addEventListener('click', () => {
                showNotification('üöß ŸÇÿ±Ÿäÿ®ÿßŸã: ÿµŸÅÿ≠ÿ© ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®', 'info');
            });
            
            // ŸÖÿ≠ÿßŸÉÿßÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑŸàŸÇÿ™ ŸàÿßŸÉÿ™ÿ≥ÿßÿ® XP
            setInterval(() => {
                if (currentUser) {
                    // ÿ•ÿ∂ÿßŸÅÿ© 1 XP ŸÉŸÑ 5 ÿØŸÇÿßÿ¶ŸÇ ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ÿßŸÑŸÜÿ¥ÿ∑ŸäŸÜ
                    addXP(1);
                }
            }, 300000); // ŸÉŸÑ 5 ÿØŸÇÿßÿ¶ŸÇ
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿ®ÿπÿ∂ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑŸàŸáŸÖŸäÿ© ÿπŸÜÿØ ÿßŸÑÿ®ÿØÿ°
            setTimeout(() => {
                if (currentUser) {
                    // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿ© ŸÖŸÜ ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                    loadRoomMessages();
                }
            }, 2000);
        });
    </script>
</body>
</html>
